<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="DoOR.functions">
<title>Visualizing DoOR • DoOR.functions</title>
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="/apple-touch-icon.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://docs.ropensci.org/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Visualizing DoOR">
<meta property="og:description" content="DoOR.functions">
<meta property="og:image" content="https://docs.ropensci.org/DoOR.functions/logo.png">
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Matomo --><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.css">
<script src="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.js" data-cfasync="false"></script><script src="https://ropensci.org/scripts/matomo.js"></script><noscript><p><img src="https://ropensci.matomo.cloud/matomo.php?idsite=1&amp;rec=1" style="border:0;" alt=""></p></noscript>
<!-- End Matomo Code -->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    <a href="https://ropensci.org" class="external-link"><img src="https://ropensci.org/img/icon_short_white.svg" id="hexlogo" alt="rOpenSci"></a>
    <a class="navbar-brand me-2" href="../index.html">DoOR.functions</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">2.0.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"></ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/DoOR.functions_main.html">The Database of Odor Responses - DoOR functions package</a>
    <a class="dropdown-item" href="../articles/DoOR_tools.html">DoOR analysis tools</a>
    <a class="dropdown-item" href="../articles/DoOR_visualizations.html">Visualizing DoOR</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ropensci/DoOR.functions/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Visualizing DoOR</h1>
                        <h4 data-toc-skip class="author">Daniel Münch</h4>
            
            <h4 data-toc-skip class="date">2024-03-19</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ropensci/DoOR.functions/blob/HEAD/vignettes/DoOR_visualizations.Rmd" class="external-link"><code>vignettes/DoOR_visualizations.Rmd</code></a></small>
      <div class="d-none name"><code>DoOR_visualizations.Rmd</code></div>
    </div>

    
    
<p>Apart from merging data and performing calculations on it, the <code>DoOR.functions</code> package provides several ways to visualize the data served by the <code>DoOR.data</code> package. Please see the <a href="DoOR.functions.html">DoOR.function vignette</a> for instructions on how to install and load both functions and data. The plotting functions can be identified by their common prefix <code>dplot_</code>, most of them make use of the <code>ggplot2</code> package which allows to override most, if not all of the theming options.</p>
<div class="section level2">
<h2 id="content">Content<a class="anchor" aria-label="anchor" href="#content"></a>
</h2>
<ul>
<li><a href="#loading">Loading data</a></li>
<li><a href="#responseMatrix">Visualizing odorants <em>vs</em> responding units with <code>dplot_response_matrix()</code></a></li>
<li><a href="#ALmap">Visualizing ensemble responses with <code>dplot_al_map()</code></a></li>
<li><a href="#tuningCurve">Visualizing tuning curves with <code>dplot_tuningCurve()</code></a></li>
<li><a href="#responseProile">Visualizing response profiles <code>dplot_response_profile()</code></a></li>
<li><a href="#compareProfiles">Comparing response profiles <code>dplot_compare_profiles()</code></a></li>
<li><a href="#acrossReceptors">Visualizing odorant responses across responding units with <code>dplot_across_ru()</code></a></li>
<li><a href="#across_OSNs">Visualizing odorant responses across OSNs with <code>dplot_across_osns()</code></a></li>
</ul>
</div>
<div class="section level2">
<h2 id="loading">Loading data<a class="anchor" aria-label="anchor" href="#loading"></a>
</h2>
<p>First we need to load packages and data:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#load data</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/DoOR.functions">DoOR.functions</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Loading required package: DoOR.data</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Welcome to DoOR.data</span></span>
<span><span class="co">## Version: 2.0.1</span></span>
<span><span class="co">## Released: 2017-03-07</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Please use load_door_data() to load all data into your workspace now.</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Welcome to DoOR.functions</span></span>
<span><span class="co">## Version: 2.0.2</span></span>
<span><span class="co">## Released: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Please note that all function names have been changed to 'snake_case'</span></span>
<span><span class="co">##        for consistency.</span></span>
<span><span class="co">##       </span></span>
<span><span class="co">## Old  'camelCase' function names will stop working in one of the next</span></span>
<span><span class="co">##        versions.</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://neuro.uni.kn/DoOR" class="external-link">DoOR.data</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/DoOR.data/man/load_door_data.html" class="external-link">load_door_data</a></span><span class="op">(</span>nointeraction <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="visualizing-odorants-vs-responding-units-with-dplot_response_matrix">Visualizing odorants <em>vs</em> responding units with <code>dplot_response_matrix()</code><a class="anchor" aria-label="anchor" href="#visualizing-odorants-vs-responding-units-with-dplot_response_matrix"></a>
</h2>
<p>{#responseMatrix} <code><a href="../reference/dplot_response_matrix.html">dplot_response_matrix()</a></code> visualizes the DoOR consensus response matrix either as a point matrix with the size of the points relating to the response strength, or as a heatmap, relating color to response strength. The default plot that is used depends on the data we enter: positive values only (like from <code>door_response_matrix</code> or <code>door_response_matrix_non_normalized</code>) which are scaled <code>[0,1]</code> will by default be plotted as a point-matrix. If we provide data that contains negative values (e.g. data with the spontaneous firing rate set to 0 via <code>reset_sfr(door_response_matrix, "SFR")</code>) it will be shown as color-coded heatmap.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/dplot_response_matrix.html">dplot_response_matrix</a></span><span class="op">(</span><span class="va">door_response_matrix</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">50</span>,<span class="op">]</span>, tag <span class="op">=</span> <span class="st">"Name"</span>, base_size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Only positive values, returning b&amp;w point plot.</span></span></code></pre>
<p><img src="DoOR_visualizations_files/figure-html/unnamed-chunk-2-1.png" width="681.6"></p>
<p>If the data contains negative values, a colored response matrix will be plotted:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/dplot_response_matrix.html">dplot_response_matrix</a></span><span class="op">(</span><span class="fu"><a href="../reference/reset_sfr.html">reset_sfr</a></span><span class="op">(</span><span class="va">door_response_matrix</span>, <span class="st">"SFR"</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">50</span>,<span class="op">]</span>, </span>
<span>                      tag <span class="op">=</span> <span class="st">"Name"</span>, base_size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span></code></pre></div>
<p><img src="DoOR_visualizations_files/figure-html/unnamed-chunk-3-1.png" width="681.6"></p>
</div>
<div class="section level2">
<h2 id="visualizing-ensemble-responses-with-dplot_al_map">Visualizing ensemble responses with <code id="ALmap">dplot_al_map()</code><a class="anchor" aria-label="anchor" href="#visualizing-ensemble-responses-with-dplot_al_map"></a>
</h2>
<p>With <code><a href="../reference/dplot_al_map.html">dplot_al_map()</a></code> we can visualize the ensemble response a given odorant elicits across DoOR responding units (receptors, sensory neurons, glomeruli, … ) as a hypothetical antennal lobe activation pattern.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/dplot_al_map.html">dplot_al_map</a></span><span class="op">(</span><span class="st">"QSJXEFYPDANLFS-UHFFFAOYSA-N"</span>, base_size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span></code></pre></div>
<p><img src="DoOR_visualizations_files/figure-html/unnamed-chunk-4-1.png" width="681.6"> If we do not know the InChIKey of the substance we are interested in, we can use the <code><a href="../reference/trans_id.html">trans_id()</a></code> function for conversion. If we are interested in the expressed receptor rather than the glomerulus names:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/dplot_al_map.html">dplot_al_map</a></span><span class="op">(</span><span class="fu"><a href="../reference/trans_id.html">trans_id</a></span><span class="op">(</span><span class="st">"benzaldehyde"</span>, from <span class="op">=</span> <span class="st">"Name"</span><span class="op">)</span>, tag <span class="op">=</span> <span class="st">"receptor"</span>, </span>
<span>             main <span class="op">=</span> <span class="st">"SMILES"</span>, base_size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span></code></pre></div>
<p><img src="DoOR_visualizations_files/figure-html/unnamed-chunk-5-1.png" width="681.6"></p>
<p>If we prefer the plain activation pattern without annotations at all:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/dplot_al_map.html">dplot_al_map</a></span><span class="op">(</span><span class="fu"><a href="../reference/trans_id.html">trans_id</a></span><span class="op">(</span><span class="st">"628-63-7"</span>, from <span class="op">=</span> <span class="st">"CAS"</span><span class="op">)</span>, tag <span class="op">=</span> <span class="st">""</span>, main <span class="op">=</span> <span class="st">""</span>, </span>
<span>             legend <span class="op">=</span> <span class="cn">FALSE</span>, scalebar <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="DoOR_visualizations_files/figure-html/unnamed-chunk-6-1.png" width="681.6"></p>
</div>
<div class="section level2">
<h2 id="visualizing-tuning-curves-with-dplot_tuningcurve">Visualizing tuning curves with <code id="tuningCurve">dplot_tuningCurve()</code><a class="anchor" aria-label="anchor" href="#visualizing-tuning-curves-with-dplot_tuningcurve"></a>
</h2>
<div class="section level3">
<h3 id="responding-units">Responding units<a class="anchor" aria-label="anchor" href="#responding-units"></a>
</h3>
<p>The set of odorants a given responding unit is responsive to can be described as its tuning curve. With <code><a href="../reference/dplot_tuningCurve.html">dplot_tuningCurve()</a></code> we can easily display such a tuning curve together with its kurtosis. Kurtosis is a measure of the shape of the tuning curve, i.e. whether a responding unit is narrowly tuned to a few odorants (high kurtosis), or whether it responds to many odorants (low kurtosis). The gaussian distribution has a kurtosis of 0.</p>
<p>If we only specify the receptor/response unit name, the data is taken from <code>door_response_matrix</code> and <code><a href="../reference/dplot_tuningCurve.html">dplot_tuningCurve()</a></code> uses <code><a href="../reference/reset_sfr.html">reset_sfr()</a></code> to reset spontaneous firing rate (or any other specified odorant) to zero before plotting.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/dplot_tuningCurve.html">dplot_tuningCurve</a></span><span class="op">(</span>receptor <span class="op">=</span> <span class="st">"Or22a"</span>, base_size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span></code></pre></div>
<p><img src="DoOR_visualizations_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<p>To prevent resetting by SFR:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/dplot_tuningCurve.html">dplot_tuningCurve</a></span><span class="op">(</span>receptor <span class="op">=</span> <span class="st">"Or22a"</span>, zero <span class="op">=</span> <span class="st">""</span>, base_size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span></code></pre></div>
<p><img src="DoOR_visualizations_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<p>We can also plot any other vector of responses, once <code>response.vector</code> is specified, the value of <code>receptor</code> is only used for the plot title and not for data lookup anymore:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/dplot_tuningCurve.html">dplot_tuningCurve</a></span><span class="op">(</span>receptor <span class="op">=</span> <span class="st">"receptor X"</span>, response.vector <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span><span class="op">)</span>, </span>
<span>                  base_size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span></code></pre></div>
<p><img src="DoOR_visualizations_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="odorants">Odorants<a class="anchor" aria-label="anchor" href="#odorants"></a>
</h3>
<p><code><a href="../reference/dplot_tuningCurve.html">dplot_tuningCurve()</a></code> can as well be used to visualize the ensemble of responding units that is activated by a given odorant. Therefore, we specify an odorant name instead of a response unit name:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/dplot_tuningCurve.html">dplot_tuningCurve</a></span><span class="op">(</span>odorant <span class="op">=</span> <span class="st">"PGMYKACGEOXYJE-UHFFFAOYSA-N"</span>, base_size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span></code></pre></div>
<p><img src="DoOR_visualizations_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<p>We can specify the chemical identifier to plot via <code>odor.main</code>:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/dplot_tuningCurve.html">dplot_tuningCurve</a></span><span class="op">(</span>odorant <span class="op">=</span> <span class="st">"PGMYKACGEOXYJE-UHFFFAOYSA-N"</span>, odor.main <span class="op">=</span> <span class="st">"SMILES"</span>,</span>
<span>                  base_size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span></code></pre></div>
<p><img src="DoOR_visualizations_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/dplot_tuningCurve.html">dplot_tuningCurve</a></span><span class="op">(</span>odorant <span class="op">=</span> <span class="st">"CURLTUGMZLYLDI-UHFFFAOYSA-N"</span>, odor.main <span class="op">=</span> <span class="st">"InChI"</span>,</span>
<span>                  base_size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span></code></pre></div>
<p><img src="DoOR_visualizations_files/figure-html/unnamed-chunk-11-2.png" width="700"></p>
<p>And finally we can control the color of the bars:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/dplot_tuningCurve.html">dplot_tuningCurve</a></span><span class="op">(</span>odorant <span class="op">=</span> <span class="fu"><a href="../reference/trans_id.html">trans_id</a></span><span class="op">(</span><span class="st">"carbon dioxide"</span>, from <span class="op">=</span> <span class="st">"Name"</span><span class="op">)</span>, </span>
<span>                  fill.odorant <span class="op">=</span> <span class="st">"#FF0000"</span>, base_size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span></code></pre></div>
<p><img src="DoOR_visualizations_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
<p>As mentioned, all of these plots are generated with the ggplot2 package which allows to override theming:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/dplot_tuningCurve.html">dplot_tuningCurve</a></span><span class="op">(</span>odorant <span class="op">=</span> <span class="fu"><a href="../reference/trans_id.html">trans_id</a></span><span class="op">(</span><span class="st">"carbon dioxide"</span>, from <span class="op">=</span> <span class="st">"Name"</span><span class="op">)</span>, </span>
<span>                  base_size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>panel.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"grey"</span>, color <span class="op">=</span> <span class="st">"magenta"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="DoOR_visualizations_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="visualizing-response-profiles-dplot_response_profile">Visualizing response profiles <code id="responseProile">dplot_response_profile()</code><a class="anchor" aria-label="anchor" href="#visualizing-response-profiles-dplot_response_profile"></a>
</h2>
<p><code>dplot_response_profile</code> creates a horizontal bar plot of the response profile of a given receptor. It displays the same data as <code>dplot_tuningCurve</code> but focusses on the odorant identity.</p>
<p>Per default the response strength is displayed as bar height as well as color code:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/dplot_response_profile.html">dplot_response_profile</a></span><span class="op">(</span><span class="st">"Gr21a.Gr63a"</span>, tag <span class="op">=</span> <span class="st">"Name"</span>, base_size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span></code></pre></div>
<p><img src="DoOR_visualizations_files/figure-html/unnamed-chunk-14-1.png" width="480"></p>
<p>We can again omit to reset to SFR:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/dplot_response_profile.html">dplot_response_profile</a></span><span class="op">(</span><span class="st">"Gr21a.Gr63a"</span>, tag <span class="op">=</span> <span class="st">"Name"</span>, base_size <span class="op">=</span> <span class="fl">8</span>, zero <span class="op">=</span><span class="st">""</span><span class="op">)</span></span></code></pre></div>
<p><img src="DoOR_visualizations_files/figure-html/unnamed-chunk-15-1.png" width="480"></p>
<p>And if we prefer monochrome data:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/dplot_response_profile.html">dplot_response_profile</a></span><span class="op">(</span><span class="st">"Gr21a.Gr63a"</span>, tag <span class="op">=</span> <span class="st">"CAS"</span>, base_size <span class="op">=</span> <span class="fl">8</span>, </span>
<span>                       colored <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="DoOR_visualizations_files/figure-html/unnamed-chunk-16-1.png" width="480"></p>
</div>
<div class="section level2">
<h2 id="comparing-response-profiles-dplot_compare_profiles">Comparing response profiles <code id="compareProfiles">dplot_compare_profiles()</code><a class="anchor" aria-label="anchor" href="#comparing-response-profiles-dplot_compare_profiles"></a>
</h2>
<p>As the name indicates, with <code><a href="../reference/dplot_compare_profiles.html">dplot_compare_profiles()</a></code> we can plot two response profiles side by side for comparison. The syntax here differs from the previous plots as we can use it also to compare the original data sets in DoOR.</p>
<div class="section level3">
<h3 id="comparing-original-data-sets">Comparing original data sets<a class="anchor" aria-label="anchor" href="#comparing-original-data-sets"></a>
</h3>
<p>This time, with <code>x</code> and <code>y</code> we have to specify a whole data.frame, <code>by.x</code> and <code>by.y</code> take the corresponding column names that will be plotted. If <code>x</code> is not specified, both <code>by.x</code> and <code>by.y</code> will be taken from <code>x</code>.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/dplot_compare_profiles.html">dplot_compare_profiles</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Or22a</span>, y <span class="op">=</span> <span class="va">Or22a</span>, by.x <span class="op">=</span> <span class="st">"Pelz.2006.AntEC50"</span>,</span>
<span>                         by.y <span class="op">=</span> <span class="st">"Hallem.2004.EN"</span>, tag <span class="op">=</span> <span class="st">"Name"</span>, base_size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span></code></pre></div>
<p><img src="DoOR_visualizations_files/figure-html/unnamed-chunk-17-1.png" width="700"></p>
<p>We see that the measured Or22a sensory neuron responses in these two data sets are in good accordance.</p>
</div>
<div class="section level3">
<h3 id="comparing-door-response-profiles">Comparing DoOR response profiles<a class="anchor" aria-label="anchor" href="#comparing-door-response-profiles"></a>
</h3>
<p>Next we compare two DoOR consensus response profiles, measurements of the misexpressed receptor Or35a and recordings from the ac3B sensory neuron that naturally expresses Or35a:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/dplot_compare_profiles.html">dplot_compare_profiles</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">door_response_matrix</span>,</span>
<span>  by.x <span class="op">=</span> <span class="st">"Or35a"</span>,</span>
<span>  by.y <span class="op">=</span> <span class="st">"ac3B"</span>,</span>
<span>  tag <span class="op">=</span> <span class="st">"Name"</span>,</span>
<span>  base_size <span class="op">=</span> <span class="fl">8</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="DoOR_visualizations_files/figure-html/unnamed-chunk-18-1.png" width="681.6"></p>
<p>or with “SFR” set to 0:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/dplot_compare_profiles.html">dplot_compare_profiles</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu"><a href="../reference/reset_sfr.html">reset_sfr</a></span><span class="op">(</span><span class="va">door_response_matrix</span>, <span class="st">"SFR"</span><span class="op">)</span>,</span>
<span>  by.x <span class="op">=</span> <span class="st">"Or35a"</span>,</span>
<span>  by.y <span class="op">=</span> <span class="st">"ac3B"</span>,</span>
<span>  tag <span class="op">=</span> <span class="st">"Name"</span>,</span>
<span>  base_size <span class="op">=</span> <span class="fl">8</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="DoOR_visualizations_files/figure-html/unnamed-chunk-19-1.png" width="681.6"></p>
<p>We see that the response profiles are very similar but not identical, which is expected as the ac3B neuron expresses other receptors in addition to Or35a.</p>
</div>
</div>
<div class="section level2">
<h2 id="visualizing-responses-across-responding-units-with-dplot_across_ru">Visualizing responses across responding units with <code>dplot_across_ru()</code><a class="anchor" aria-label="anchor" href="#visualizing-responses-across-responding-units-with-dplot_across_ru"></a>
</h2>
<p>{#acrossReceptors} With <code><a href="../reference/dplot_across_ru.html">dplot_across_ru()</a></code> we can visualize the responses that one or several odorants elicit across receptors / responding units.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">odors</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/trans_id.html">trans_id</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pentyl acetate"</span>, <span class="st">"carbon dioxide"</span>, <span class="st">"2,3-butanedione"</span><span class="op">)</span>, </span>
<span>           from <span class="op">=</span> <span class="st">"Name"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="../reference/dplot_across_ru.html">dplot_across_ru</a></span><span class="op">(</span><span class="va">odors</span>, tag <span class="op">=</span> <span class="st">"Name"</span>, base_size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span></code></pre></div>
<p><img src="DoOR_visualizations_files/figure-html/unnamed-chunk-20-1.png" width="576"></p>
</div>
<div class="section level2">
<h2 id="visualizing-odorant-responses-across-osns-with-dplot_across_osns">Visualizing odorant responses across OSNs with <code>dplot_across_osns()</code><a class="anchor" aria-label="anchor" href="#visualizing-odorant-responses-across-osns-with-dplot_across_osns"></a>
</h2>
<p>{#across_OSNs} <code><a href="../reference/dplot_across_osns.html">dplot_across_osns()</a></code> is similar to <code><a href="../reference/dplot_across_ru.html">dplot_across_ru()</a></code> but the responding units are sorted according to the sensory neuron they belong to. This sorting is controlled via <code>door_mappings</code> from the <code>DoOR.data</code> package. There are two types of plot that <code><a href="../reference/dplot_across_osns.html">dplot_across_osns()</a></code> can return. Type 2 directly resembles <code><a href="../reference/dplot_across_ru.html">dplot_across_ru()</a></code>:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/dplot_across_osns.html">dplot_across_osns</a></span><span class="op">(</span><span class="va">odors</span>, base_size <span class="op">=</span> <span class="fl">8</span>, plot.type <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 37 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_bar()`).</span></span></code></pre>
<p><img src="DoOR_visualizations_files/figure-html/unnamed-chunk-21-1.png" width="576"></p>
<p>In type 1 the data is split according to odorant X sensillum, the color is assigned to the corresponding neuron A-D or X-Z if the neuron’s identity is unknown:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/dplot_across_osns.html">dplot_across_osns</a></span><span class="op">(</span><span class="va">odors</span>, base_size <span class="op">=</span> <span class="fl">8</span>, plot.type <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 37 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_bar()`).</span></span></code></pre>
<p><img src="DoOR_visualizations_files/figure-html/unnamed-chunk-22-1.png" width="681.6"></p>
<p>As this plot gets pretty messy, we have the option to restrict plotting to certain subsets of sensilla. We can for example only plot the responses of antennal basiconic (ab) sensilla:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/dplot_across_osns.html">dplot_across_osns</a></span><span class="op">(</span><span class="va">odors</span>, base_size <span class="op">=</span> <span class="fl">8</span>, plot.type <span class="op">=</span> <span class="fl">1</span>, sub <span class="op">=</span> <span class="st">"ab"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 2 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_bar()`).</span></span></code></pre>
<p><img src="DoOR_visualizations_files/figure-html/unnamed-chunk-23-1.png" width="681.6"></p>
<p>Or we plot coeloconic and trichoid sensilla:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/dplot_across_osns.html">dplot_across_osns</a></span><span class="op">(</span><span class="va">odors</span>, base_size <span class="op">=</span> <span class="fl">8</span>, plot.type <span class="op">=</span> <span class="fl">1</span>, sub <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ac"</span>, <span class="st">"at"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 19 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_bar()`).</span></span></code></pre>
<p><img src="DoOR_visualizations_files/figure-html/unnamed-chunk-24-1.png" width="681.6"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><!-- begin footer --><div class="footer">
    <div class="container">
        <div class="row start top-4 bottom-8">
            <div class="col-2"> <img id="footerlogo" src="https://ropensci.org/img/icon_short_white.svg">
</div>
            <div class="col-10">
                <div class="row">
                    <div class="col-md-4 col-xs-6">
                        <a href="https://github.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-github"></div></a>
                        <a href="https://github.com/ropenscilabs" target="_blank" class="external-link"><div class="icon fa fa-flask"></div></a>
                        <a href="https://hachyderm.io/@ropensci" target="_blank" class="external-link"><div class="icon fab fa-mastodon"></div></a>
                        <a href="https://vimeo.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-vimeo"></div></a>
                    </div>
                </div>
                <div class="row top-4">
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">About</h5>
                            <li><a href="https://ropensci.org/about" class="external-link">About rOpenSci</a></li>
                            <li><a href="https://ropensci.org/software-review" class="external-link">Software Review</a></li>
                            <li><a href="https://ropensci.org/about#team" class="external-link">Our Team</a></li>
                            <li><a href="https://ropensci.org/careers" class="external-link">Jobs</a></li>
                            <li><a href="https://ropensci.org/donate" class="external-link">Donate</a></li>
                            <li><a href="https://ropensci.org/contact" class="external-link">Contact Us</a></li>
                        </ul>
</div>
                    <div class="col-md-3 col-sm-4">
                        <ul>
<h5 class="bottom-2">Community</h5>
                            <li><a href="https://ropensci.org/community/" class="external-link">Our Community</a></li>
                            <li><a href="https://ropensci.org/commcalls/" class="external-link">Community calls</a></li>
                            <li><a href="https://ropensci.org/events/" class="external-link">Events</a></li>
                            <li><a href="https://discuss.ropensci.org/" class="external-link">Join the Discussion</a></li>
                            <li><a href="https://ropensci.org/code-of-conduct" class="external-link">Code of conduct</a></li>
                        </ul>
</div>
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">Resources</h5>
                            <li><a href="https://ropensci.org/packages/" class="external-link">Packages</a></li>
                            <li><a href="https://ropensci.org/usecases/" class="external-link">Use Cases</a></li>
                            <li><a href="https://ropensci.org/talks-papers/" class="external-link">Talks &amp; Publications</a></li>
                            <li><a href="https://docs.ropensci.org/" class="external-link">Documentation</a></li>
                            <li><a href="https://ropensci.org/news/" class="external-link">Newsletter</a></li>
                            <li><a href="https://ropensci.org/how-to-cite-ropensci/" class="external-link">Cite rOpenSci</a></li>
                        </ul>
</div>
                    <div class="col-md-4 col-xs-12">
                        <h5 class="bottom-2"></h5>

                        <p>rOpenSci is a fiscally sponsored project of <a href="http://numfocus.org" class="external-link">NumFOCUS</a>.</p>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- / end footer -->


    </footer>
</div>

  

  

  </body>
</html>
