<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="DoOR.functions">
<title>DoOR analysis tools • DoOR.functions</title>
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="/apple-touch-icon.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://docs.ropensci.org/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="DoOR analysis tools">
<meta property="og:description" content="DoOR.functions">
<meta property="og:image" content="https://docs.ropensci.org/DoOR.functions/logo.png">
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Matomo --><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.css">
<script src="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.js" data-cfasync="false"></script><script src="https://ropensci.org/scripts/matomo.js"></script><noscript><p><img src="https://ropensci.matomo.cloud/matomo.php?idsite=1&amp;rec=1" style="border:0;" alt=""></p></noscript>
<!-- End Matomo Code -->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    <a href="https://ropensci.org" class="external-link"><img src="https://ropensci.org/img/icon_short_white.svg" id="hexlogo" alt="rOpenSci"></a>
    <a class="navbar-brand me-2" href="../index.html">DoOR.functions</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">2.0.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"></ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/DoOR.functions_main.html">The Database of Odor Responses - DoOR functions package</a>
    <a class="dropdown-item" href="../articles/DoOR_tools.html">DoOR analysis tools</a>
    <a class="dropdown-item" href="../articles/DoOR_visualizations.html">Visualizing DoOR</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ropensci/DoOR.functions/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>DoOR analysis tools</h1>
                        <h4 data-toc-skip class="author">Daniel Münch</h4>
            
            <h4 data-toc-skip class="date">2024-03-19</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ropensci/DoOR.functions/blob/HEAD/vignettes/DoOR_tools.Rmd" class="external-link"><code>vignettes/DoOR_tools.Rmd</code></a></small>
      <div class="d-none name"><code>DoOR_tools.Rmd</code></div>
    </div>

    
    
<p>The <code>DoOR.functions</code> package provides tools for the analysis of the data provided by the <code>DoOR.data</code> package.</p>
<div class="section level2">
<h2 id="content">Content<a class="anchor" aria-label="anchor" href="#content"></a>
</h2>
<ul>
<li><a href="#loading">Loading data</a></li>
<li><a href="#identify_sensillum">Identifying the sensillum we are recording from with <code>identify_sensillum()</code></a></li>
<li><a href="#private_odorant">Finding neuron-specific odorants with <code>private_odorant()</code></a></li>
<li><a href="#map_receptor">Mapping response data from an unknown source with <code>map_receptor()</code></a></li>
<li><a href="#back_project">Changing the response unit with <code>back_project()</code></a></li>
<li><a href="#sparse">Quantifying tuning curves with <code>sparse()</code></a></li>
</ul>
</div>
<div class="section level2">
<h2 id="loading">Loading data<a class="anchor" aria-label="anchor" href="#loading"></a>
</h2>
<p>First we need to load packages and data:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#load data</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/DoOR.functions">DoOR.functions</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Loading required package: DoOR.data</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Welcome to DoOR.data</span></span>
<span><span class="co">## Version: 2.0.1</span></span>
<span><span class="co">## Released: 2017-03-07</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Please use load_door_data() to load all data into your workspace now.</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Welcome to DoOR.functions</span></span>
<span><span class="co">## Version: 2.0.2</span></span>
<span><span class="co">## Released: </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Please note that all function names have been changed to 'snake_case'</span></span>
<span><span class="co">##        for consistency.</span></span>
<span><span class="co">##       </span></span>
<span><span class="co">## Old  'camelCase' function names will stop working in one of the next</span></span>
<span><span class="co">##        versions.</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://neuro.uni.kn/DoOR" class="external-link">DoOR.data</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/DoOR.data/man/load_door_data.html" class="external-link">load_door_data</a></span><span class="op">(</span>nointeraction <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="identifying-the-sensillum-we-are-recording-from-with-identify_sensillum">Identifying the sensillum we are recording from with <code>identify_sensillum()</code><a class="anchor" aria-label="anchor" href="#identifying-the-sensillum-we-are-recording-from-with-identify_sensillum"></a>
</h2>
<p>{#identify_sensillum} Imagine we perform an electrophysiological recording from a <em>Drosophila</em> sensillum (single sensillum recording, SSR) and we are not sure what sensillum we are recording from. In order to identify the sensillum we used several diagnostic odorants (maybe selected using <a href="#private_odorant"><code>private_odorant()</code></a>) and got responses from the different sensory neurons the sensillum houses. We can now pass our recorded data to <code><a href="../reference/identify_sensillum.html">identify_sensillum()</a></code>.</p>
<p>Let’s make up some simple fake data. We pretend to have recorded with three odorants (2,3-butanedione, ethanoic acid and carbon dioxide) and we could separate the responses of two units. Unit1 responded strongly to 2,3-butanedione only, unit2 only responded to carbon dioxide. We create a data.frame that contains a column called <code>odorants</code> with the InChIKeys of our test odorants, and one column for each unit (name the colnames as you like, e.g. unit1-n or Aneuro if you are sure about the neuron).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">recording</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  odorants <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="../reference/trans_id.html">trans_id</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BEDN"</span>, <span class="st">"ETAS"</span><span class="op">)</span>, <span class="st">"Code"</span><span class="op">)</span>,</span>
<span>               <span class="fu"><a href="../reference/trans_id.html">trans_id</a></span><span class="op">(</span><span class="st">"carbon dioxide"</span>, <span class="st">"Name"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  unit1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.9</span>,<span class="fl">.1</span>,<span class="fl">.1</span><span class="op">)</span>,</span>
<span>  unit2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">.1</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Next we feed the recording to the function:</p>
<div class="section level3">
<h3 id="using-correlations">using correlations<a class="anchor" aria-label="anchor" href="#using-correlations"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/identify_sensillum.html">identify_sensillum</a></span><span class="op">(</span><span class="va">recording</span>, base_size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## found correlations above 0.9 for all 2 units in: ab1</span></span></code></pre>
<p><img src="DoOR_tools_files/figure-html/unnamed-chunk-3-1.png" width="681.6"> Note that the function tells us that it found hits for all units in ab1 and ab5, meaning that e.g. within the four neurons housed in the ab1 sensillum both of our units had good matches. You can set this correlation threshold with <code>min.cor</code>. If we increase the threshold to 0.99 only ab1 is returned as a double match:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/identify_sensillum.html">identify_sensillum</a></span><span class="op">(</span><span class="va">recording</span>, min.cor <span class="op">=</span> <span class="fl">.99</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## found correlations above 0.99 for all 2 units in: ab1</span></span></code></pre>
<p>We can define the number of best hits that we want to get returned (the default is 10):</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/identify_sensillum.html">identify_sensillum</a></span><span class="op">(</span><span class="va">recording</span>, nshow <span class="op">=</span> <span class="fl">5</span>, base_size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## found correlations above 0.9 for all 2 units in: ab1</span></span></code></pre>
<p><img src="DoOR_tools_files/figure-html/unnamed-chunk-5-1.png" width="681.6"> And if we know e.g. that we are recording from a basiconic sensillum we can restrict the search to one or a few sensilla types:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/identify_sensillum.html">identify_sensillum</a></span><span class="op">(</span><span class="va">recording</span>, sub <span class="op">=</span> <span class="st">"ab"</span>, nshow <span class="op">=</span> <span class="fl">5</span>, base_size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## found correlations above 0.9 for all 2 units in: ab1</span></span></code></pre>
<p><img src="DoOR_tools_files/figure-html/unnamed-chunk-6-1.png" width="681.6"></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/identify_sensillum.html">identify_sensillum</a></span><span class="op">(</span><span class="va">recording</span>, sub <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ac"</span>,<span class="st">"at"</span><span class="op">)</span>, nshow <span class="op">=</span> <span class="fl">5</span>, base_size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span></code></pre></div>
<p><img src="DoOR_tools_files/figure-html/unnamed-chunk-6-2.png" width="681.6"></p>
</div>
<div class="section level3">
<h3 id="using-euclidean-distances">using Euclidean distances<a class="anchor" aria-label="anchor" href="#using-euclidean-distances"></a>
</h3>
<p>Instead of correlations we can also use the Euclidean distance as a (dis)similarity measure:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/identify_sensillum.html">identify_sensillum</a></span><span class="op">(</span><span class="va">recording</span>, method <span class="op">=</span> <span class="st">"dist"</span>, sub <span class="op">=</span> <span class="st">"ab"</span>, nshow <span class="op">=</span> <span class="fl">5</span>, </span>
<span>                   base_size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 2 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_bar()`).</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 1 row containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_bar()`).</span></span></code></pre>
<p><img src="DoOR_tools_files/figure-html/unnamed-chunk-7-1.png" width="681.6"></p>
</div>
<div class="section level3">
<h3 id="returning-data-instead-of-plots">returning data instead of plots<a class="anchor" aria-label="anchor" href="#returning-data-instead-of-plots"></a>
</h3>
<p>We can also return the correlation/distance data instead of the plot when setting <code>plot =FALSE</code>:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sensillumX</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/identify_sensillum.html">identify_sensillum</a></span><span class="op">(</span><span class="va">recording</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"dist"</span>,</span>
<span>  sub <span class="op">=</span> <span class="st">"ab"</span>,</span>
<span>  plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">sensillumX</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##       receptor sensillum  OSN     unit1     unit2</span></span>
<span><span class="co">## Or7a      Or7a       ab4 ab4A 0.7131111 0.9430477</span></span>
<span><span class="co">## Or9a      Or9a       ab8 ab8B 0.5688357 1.0031663</span></span>
<span><span class="co">## Or10a    Or10a       ab1 ab1D 0.8497591 0.9363670</span></span>
<span><span class="co">## Or13a    Or13a       ab6 ab6A 0.6763409 0.8639653</span></span>
<span><span class="co">## Or22a    Or22a       ab3 ab3A 0.6596756 0.9979447</span></span>
<span><span class="co">## Or22b    Or22b       ab3 ab3A 0.1732051 1.7320508</span></span></code></pre>
<p>So apparently our fake recording came from the ab1 sensillum, which was admittedly quite obvious as we had a strong carbon dioxide response and ab1 houses the carbon dioxide receptor :)</p>
</div>
</div>
<div class="section level2">
<h2 id="private_odorant">Finding neuron-specific odorants with <code>private_odorant()</code><a class="anchor" aria-label="anchor" href="#private_odorant"></a>
</h2>
<p>There may be several cases where we might be interested in so called <em>private odorants</em>, odorants that specifically activate a given receptor or sensory neuron. Maybe we are looking for diagnostic odorants for sensillum identification or we want to activate a specific neuronal pathway, <code><a href="../reference/private_odorant.html">private_odorant()</a></code> returns candidate odorants for that task.</p>
<p>Let’s say we want to specifically activate Or22a neurons:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/private_odorant.html">private_odorant</a></span><span class="op">(</span><span class="st">"Or22a"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                                  Or22a   max.others  n difference</span></span>
<span><span class="co">## GQKZRWSUJHVIPE-UHFFFAOYSA-N 0.43570150 -0.001626778  4  0.4373283</span></span>
<span><span class="co">## SHZIWNPUGXLXDT-UHFFFAOYSA-N 0.78193674  0.417131636 29  0.3648051</span></span>
<span><span class="co">## JGHZJRVDZXSNKQ-UHFFFAOYSA-N 0.52492990  0.243725635 28  0.2812043</span></span>
<span><span class="co">## HCRBXQFHJMCTLF-UHFFFAOYSA-N 0.53683628  0.368857494 20  0.1679788</span></span>
<span><span class="co">## SMQUZDBALVYZAC-UHFFFAOYSA-N 0.07433042 -0.075854326  1  0.1501847</span></span></code></pre>
<p>We might want to return the odorant names instead of InChiKeys:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/private_odorant.html">private_odorant</a></span><span class="op">(</span><span class="st">"Or22a"</span>, tag <span class="op">=</span> <span class="st">"Name"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                              Or22a   max.others  n difference</span></span>
<span><span class="co">## sec-amyl acetate        0.43570150 -0.001626778  4  0.4373283</span></span>
<span><span class="co">## ethyl hexanoate         0.78193674  0.417131636 29  0.3648051</span></span>
<span><span class="co">## methyl octanoate        0.52492990  0.243725635 28  0.2812043</span></span>
<span><span class="co">## ethyl 2-methylbutanoate 0.53683628  0.368857494 20  0.1679788</span></span>
<span><span class="co">## salicyl aldehyde        0.07433042 -0.075854326  1  0.1501847</span></span></code></pre>
<p>So according to the function sec-amyl acetate would be a good candidate. It activates Or22a at 0.4 (DoOR response, max is 1) while the maximum activation in all other tested responding units (receptors, neurons, glomeruli) is 0.016, a difference of 0.40. Sounds good, but it was tested only in 4 other responding units, so I would rather go for ethyl hexanoate with about the same difference but being tested in 29 other responding units.</p>
<p>We can also restrict the search to the sensillum the responding units of interest is related to:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/private_odorant.html">private_odorant</a></span><span class="op">(</span><span class="st">"Or22a"</span>, tag <span class="op">=</span> <span class="st">"Name"</span>, sensillum <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## &gt;&gt; Checking only against the ab3 sensillum (Or22a, Or22b, Or85b) &lt;&lt;</span></span></code></pre>
<pre><code><span><span class="co">##                             Or22a max.others n difference</span></span>
<span><span class="co">## ethyl hexanoate         0.7819367 0.23844314 1  0.5434936</span></span>
<span><span class="co">## ethyl 2-methylbutanoate 0.5368363 0.03107633 1  0.5057599</span></span>
<span><span class="co">## diethyl succinate       0.4659812 0.05652431 1  0.4094569</span></span>
<span><span class="co">## methyl octanoate        0.5249299 0.14747177 1  0.3774581</span></span>
<span><span class="co">## E2-hexenyl acetate      0.4271672 0.05042492 1  0.3767423</span></span></code></pre>
<p>Ethyl 2-methylbutanoate sounds like a good hit, it has the same difference to the other units as ethyl hexanoate but hardly elicits a response at all from the other neuron. The n of 1 is fine as there are only 2 neurons housed in the ab3 sensillum.</p>
</div>
<div class="section level2">
<h2 id="mapping-response-data-from-an-unknown-source-with-map_receptor">Mapping response data from an unknown source with <code>map_receptor()</code><a class="anchor" aria-label="anchor" href="#mapping-response-data-from-an-unknown-source-with-map_receptor"></a>
</h2>
<p>{#map_receptor} Similar to <code><a href="../reference/identify_sensillum.html">identify_sensillum()</a></code>, <code><a href="../reference/map_receptor.html">map_receptor()</a></code> correlates a response vector to all responding units of the existing DoOR consensus data. Let’s grab a data set from Or22a and see where it ends up:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>odorants  <span class="op">=</span> <span class="va">Or22a</span><span class="op">$</span><span class="va">InChIKey</span>, responses <span class="op">=</span> <span class="va">Or22a</span><span class="op">$</span><span class="va">Hallem.2006.EN</span><span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                       odorants responses</span></span>
<span><span class="co">## 1                          SFR         4</span></span>
<span><span class="co">## 3  VHUUQVKOLVNVRT-UHFFFAOYSA-N        17</span></span>
<span><span class="co">## 4  KIDHWZJUCRJVML-UHFFFAOYSA-N        16</span></span>
<span><span class="co">## 5  VHRGRCVQAFMJIZ-UHFFFAOYSA-N        17</span></span>
<span><span class="co">## 11 YEJRWHAVMIAJKC-UHFFFAOYSA-N        47</span></span>
<span><span class="co">## 12 JBFHTYHTHYHCDJ-UHFFFAOYSA-N       144</span></span></code></pre>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/map_receptor.html">map_receptor</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, nshow <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## skipped Or22c, Or24a, Or67d, pb2A as overlap (n) was &lt; 3</span></span></code></pre>
<pre><code><span><span class="co">##       responding.unit   n       cor      p.value</span></span>
<span><span class="co">## Or22a           Or22a 111 0.9658036 9.929338e-66</span></span>
<span><span class="co">## Or47a           Or47a 111 0.7087026 3.270693e-18</span></span>
<span><span class="co">## Or59c           Or59c  18 0.6657733 2.561096e-03</span></span>
<span><span class="co">## Or43b           Or43b 111 0.6322969 9.835057e-14</span></span>
<span><span class="co">## Or2a             Or2a 111 0.6157970 6.342287e-13</span></span></code></pre>
<p>This example was a bit circular as the tested data contributed to the consensus data…</p>
</div>
<div class="section level2">
<h2 id="changing-the-response-unit-spikes-deltaff-with-back_project">Changing the response unit (spikes, deltaF/F, …) with <code>back_project()</code><a class="anchor" aria-label="anchor" href="#changing-the-response-unit-spikes-deltaff-with-back_project"></a>
</h2>
<p>{#back_project} The DoOR consensus data is normalized to values between 0 and 1. If we want to compare the DoOR data to one of our own recordings, it would be great to have the DoOR data in the same unit as our owne data (e.g. spikerate). This is what we can do with <code><a href="../reference/back_project.html">back_project()</a></code>, we can rescale the DoOR data to fit a given response template.</p>
<p>As an example, let’s take the data Hallem et al. recorded from Or22a <em>via</em> calcium imaging and rescale the DoOR responses accordingly. The template has to have 2 columns named <code>odorants</code> and <code>responses</code>:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">template</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>odorants  <span class="op">=</span> <span class="va">Or22a</span><span class="op">$</span><span class="va">InChIKey</span>,</span>
<span>                       responses <span class="op">=</span> <span class="va">Or22a</span><span class="op">$</span><span class="va">Hallem.2006.EN</span><span class="op">)</span></span>
<span></span>
<span><span class="va">bp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/back_project.html">back_project</a></span><span class="op">(</span><span class="va">template</span>, responding.unit <span class="op">=</span> <span class="st">"Or22a"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: selfStart initializing functions should have a final '...' argument</span></span>
<span><span class="co">## since R 4.1.0</span></span>
<span></span>
<span><span class="co">## Warning: selfStart initializing functions should have a final '...' argument</span></span>
<span><span class="co">## since R 4.1.0</span></span></code></pre>
<p><img src="DoOR_tools_files/figure-html/unnamed-chunk-13-1.png" width="432"></p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">bp</span><span class="op">$</span><span class="va">back_projected</span><span class="op">$</span><span class="va">original.data</span>,</span>
<span>     <span class="va">bp</span><span class="op">$</span><span class="va">back_projected</span><span class="op">$</span><span class="va">back_projected.data</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"DoOR consensus response"</span>,</span>
<span>     ylab <span class="op">=</span> <span class="st">"back_projected data [spikes, Hallem.2006.EN]"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="DoOR_tools_files/figure-html/unnamed-chunk-13-2.png" width="432"></p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">bp</span><span class="op">$</span><span class="va">back_projected</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                      odorants back_projected.data original.data template.data</span></span>
<span><span class="co">## 1                         SFR            6.620103    0.08448516             4</span></span>
<span><span class="co">## 2 XLYOFNOQVPJJNP-UHFFFAOYSA-N          133.355630    0.36799124            NA</span></span>
<span><span class="co">## 3 VHUUQVKOLVNVRT-UHFFFAOYSA-N           29.409493    0.18498406            17</span></span>
<span><span class="co">## 4 KIDHWZJUCRJVML-UHFFFAOYSA-N           27.357834    0.17511431            16</span></span>
<span><span class="co">## 5 VHRGRCVQAFMJIZ-UHFFFAOYSA-N           16.069298    0.08989517            17</span></span>
<span><span class="co">## 6 QGZKDVFQNNGYKY-UHFFFAOYSA-N           13.558241    0.08805285            NA</span></span>
<span><span class="co">##   fitted.data</span></span>
<span><span class="co">## 1  0.06872184</span></span>
<span><span class="co">## 2  0.51358830</span></span>
<span><span class="co">## 3  0.14871705</span></span>
<span><span class="co">## 4  0.14151533</span></span>
<span><span class="co">## 5  0.10189036</span></span>
<span><span class="co">## 6  0.09307606</span></span></code></pre>
<p>All the yellow lines in the first plot represent odorant responses that were not available in the original data set but were projected onto the fitted function and rescaled to the units in “Hallem.2006.EN”. The second plot shows the relationship between the rescaled data and the original consensus responses.</p>
</div>
<div class="section level2">
<h2 id="quantifying-tuning-curves-with-sparse">Quantifying tuning curves with <code id="sparse">sparse()</code><a class="anchor" aria-label="anchor" href="#quantifying-tuning-curves-with-sparse"></a>
</h2>
<p>The width of a tuning curve, i.e. for example to how many odorants a receptor shows strong responses, can be quantified using different sparseness measures. We implemented kurtosis<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Willmore, B., Tolhurst, D.J., 2001. Characterizing the sparseness of neural codes. Network 12, 255–270. dx.doi.org/10.1080/net.12.3.255.270&lt;/p&gt;"><sup>1</sup></a> and sparseness<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Bhandawat, V., Olsen, S.R., Gouwens, N.W., Schlief, M.L., Wilson, R.I., 2007. Sensory processing in the Drosophila antennal lobe increases reliability and separability of ensemble odor representations. Nature neuroscience 10, 1474–82. dx.doi.org/10.1038/nn1976&lt;/p&gt;"><sup>2</sup></a> in <code><a href="../reference/sparse.html">sparse()</a></code>. A high kurtosis or sparseness value indicates a narrow tuning curve (see also <code><a href="../reference/dplot_tuningCurve.html">dplot_tuningCurve()</a></code> in the <a href="DoOR_visualizations.html#tuningCurve">DoOR visualization vignette</a>). While kurtosis is able to deal with negative values, sparseness can’t and thus all values need to be be transformed to absolute values first. Sparseness scales between 0 and 1, kurtosis between -∞ and ∞, a kurtisis of 0 corresponds to the Gaussian distribution.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rm.SFRreset</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reset_sfr.html">reset_sfr</a></span><span class="op">(</span><span class="va">door_response_matrix</span>, <span class="st">"SFR"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/sparse.html">sparse</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">rm.SFRreset</span><span class="op">[</span>,<span class="st">"Or69a"</span><span class="op">]</span>, method <span class="op">=</span> <span class="st">"ltk"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] -0.2615938</span></span></code></pre>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sparse.html">sparse</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">rm.SFRreset</span><span class="op">[</span>,<span class="st">"Or69a"</span><span class="op">]</span>, method <span class="op">=</span> <span class="st">"lts"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.1486392</span></span></code></pre>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sparse.html">sparse</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">rm.SFRreset</span><span class="op">[</span>,<span class="st">"Gr21a.Gr63a"</span><span class="op">]</span>, method <span class="op">=</span> <span class="st">"ltk"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 23.57197</span></span></code></pre>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sparse.html">sparse</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">rm.SFRreset</span><span class="op">[</span>,<span class="st">"Gr21a.Gr63a"</span><span class="op">]</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"lts"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.7596749</span></span></code></pre>
</div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><!-- begin footer --><div class="footer">
    <div class="container">
        <div class="row start top-4 bottom-8">
            <div class="col-2"> <img id="footerlogo" src="https://ropensci.org/img/icon_short_white.svg">
</div>
            <div class="col-10">
                <div class="row">
                    <div class="col-md-4 col-xs-6">
                        <a href="https://github.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-github"></div></a>
                        <a href="https://github.com/ropenscilabs" target="_blank" class="external-link"><div class="icon fa fa-flask"></div></a>
                        <a href="https://hachyderm.io/@ropensci" target="_blank" class="external-link"><div class="icon fab fa-mastodon"></div></a>
                        <a href="https://vimeo.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-vimeo"></div></a>
                    </div>
                </div>
                <div class="row top-4">
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">About</h5>
                            <li><a href="https://ropensci.org/about" class="external-link">About rOpenSci</a></li>
                            <li><a href="https://ropensci.org/software-review" class="external-link">Software Review</a></li>
                            <li><a href="https://ropensci.org/about#team" class="external-link">Our Team</a></li>
                            <li><a href="https://ropensci.org/careers" class="external-link">Jobs</a></li>
                            <li><a href="https://ropensci.org/donate" class="external-link">Donate</a></li>
                            <li><a href="https://ropensci.org/contact" class="external-link">Contact Us</a></li>
                        </ul>
</div>
                    <div class="col-md-3 col-sm-4">
                        <ul>
<h5 class="bottom-2">Community</h5>
                            <li><a href="https://ropensci.org/community/" class="external-link">Our Community</a></li>
                            <li><a href="https://ropensci.org/commcalls/" class="external-link">Community calls</a></li>
                            <li><a href="https://ropensci.org/events/" class="external-link">Events</a></li>
                            <li><a href="https://discuss.ropensci.org/" class="external-link">Join the Discussion</a></li>
                            <li><a href="https://ropensci.org/code-of-conduct" class="external-link">Code of conduct</a></li>
                        </ul>
</div>
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">Resources</h5>
                            <li><a href="https://ropensci.org/packages/" class="external-link">Packages</a></li>
                            <li><a href="https://ropensci.org/usecases/" class="external-link">Use Cases</a></li>
                            <li><a href="https://ropensci.org/talks-papers/" class="external-link">Talks &amp; Publications</a></li>
                            <li><a href="https://docs.ropensci.org/" class="external-link">Documentation</a></li>
                            <li><a href="https://ropensci.org/news/" class="external-link">Newsletter</a></li>
                            <li><a href="https://ropensci.org/how-to-cite-ropensci/" class="external-link">Cite rOpenSci</a></li>
                        </ul>
</div>
                    <div class="col-md-4 col-xs-12">
                        <h5 class="bottom-2"></h5>

                        <p>rOpenSci is a fiscally sponsored project of <a href="http://numfocus.org" class="external-link">NumFOCUS</a>.</p>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- / end footer -->


    </footer>
</div>

  

  

  </body>
</html>
